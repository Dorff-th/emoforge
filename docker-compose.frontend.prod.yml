version: "3.9"

services:
  # =============================
  # ğŸ§  Auth Frontend (ë¡œê·¸ì¸/íšŒì›)
  # =============================
  auth-frontend:
    build:
      context: ./auth-frontend
      dockerfile: Dockerfile
    container_name: auth-frontend
    ports:
      - "8180:80"  # ğŸ”¸ ë³€ê²½: devì—ì„œëŠ” 5173, ìš´ì˜ì—ì„œëŠ” nginx ë‚´ë¶€ 80í¬íŠ¸ë§Œ ì‚¬ìš©
    environment:
      # ğŸ”¸ ë³€ê²½: ë‚´ë¶€ ì„œë¹„ìŠ¤ URL â†’ ì™¸ë¶€ HTTPS ê¸°ë°˜
      VITE_API_AUTH_BASE_URL: https://www.emoforge.dev/api/auth
      VITE_API_ATTACH_BASE_URL: https://www.emoforge.dev/api/attach
      VITE_APP_AUTH_URL: https://www.emoforge.dev
      VITE_APP_DIARY_URL: https://www.emoforge.dev/diary
      # ğŸ—‘ï¸ ì œê±°: VITE_APP_POST_URL (post-frontend ì œê±°ë¡œ ë¶ˆí•„ìš”)
    networks:
      - emoforge-net

  # =============================
  # ğŸŒ¿ Diary Frontend (ê°ì •ì¼ê¸°)
  # =============================
  diary-frontend:
    build:
      context: ./diary-frontend
      dockerfile: Dockerfile
    container_name: diary-frontend
    ports:
      - "8181:80"  # ğŸ”¸ ë³€ê²½: devì—ì„œëŠ” 5175, ìš´ì˜ì—ì„œëŠ” ë‚´ë¶€ nginxë¡œ í†µí•© ê°€ëŠ¥
    environment:
      # ğŸ”¸ ë³€ê²½: ë‚´ë¶€ ë„ì»¤ ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ â†’ HTTPS ì™¸ë¶€ ì£¼ì†Œ
      VITE_API_DIARY_BASE_URL: https://www.emoforge.dev/api/diary
      VITE_API_AUTH_BASE_URL: https://www.emoforge.dev/api/auth
      VITE_API_ATTACH_BASE_URL: https://www.emoforge.dev/api/attach
      VITE_API_LANGGRAPH_BASE_URL: https://www.emoforge.dev/api/langgraph
      VITE_APP_DIARY_URL: https://www.emoforge.dev/diary
      VITE_APP_AUTH_URL: https://www.emoforge.dev
      # ğŸ—‘ï¸ ì œê±°: VITE_APP_POST_URL (post-frontend ì œê±°ë¡œ ë¶ˆí•„ìš”)
    networks:
      - emoforge-net

  # =============================
  # ğŸ› ï¸ Admin Frontend (ê´€ë¦¬ì)
  # =============================
  admin-frontend:
    build:
      context: ./admin-frontend
      dockerfile: Dockerfile
    container_name: admin-frontend
    ports:
      - "8182:80"  # ğŸ”¸ ë³€ê²½: devì—ì„œëŠ” 5176, ìš´ì˜ nginx ë‚´ë¶€ í¬íŠ¸ë¡œ í†µì¼
    environment:
      VITE_API_AUTH_BASE_URL: https://www.emoforge.dev/api/auth
      VITE_APP_ADMIN_URL: https://www.emoforge.dev/admin
      VITE_APP_AUTH_URL: https://www.emoforge.dev
    networks:
      - emoforge-net

  # =============================
  # ğŸ› ï¸ Post Frontend (ê²Œì‹œíŒ)
  # =============================
  post-frontend:
    build:
      context: ./post-frontend
      dockerfile: Dockerfile
    container_name: post-frontend
    ports:
      - "8183:80"  # ğŸ”¸ ë³€ê²½: devì—ì„œëŠ” 5176, ìš´ì˜ nginx ë‚´ë¶€ í¬íŠ¸ë¡œ í†µì¼
    environment:
      VITE_API_AUTH_BASE_URL: https://www.emoforge.dev/api/auth
      VITE_APP_ADMIN_URL: https://www.emoforge.dev/admin
      VITE_APP_AUTH_URL: https://www.emoforge.dev
    networks:
      - emoforge-net


networks:
  emoforge-net:
    external: true      
